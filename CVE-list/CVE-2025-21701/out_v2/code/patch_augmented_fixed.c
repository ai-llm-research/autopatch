

struct net_device {
    struct device { int parent; } dev;
    struct ethtool_ops {
        int (*begin)(struct net_device *);
    } *ethtool_ops;
    int reg_state;
};

int ENODEV = -19;
int NETREG_UNREGISTERING = 2;

typedef int bool;
#define true 1
#define false 0

bool netif_device_present(struct net_device *dev) {
    return true;
}

void pm_runtime_get_sync(int parent) {
}

void pm_runtime_put(int parent) {
}

int ethnl_ops_begin(struct net_device *dev) {
    int flag;

    if (!dev)
        return -ENODEV;

    if (dev->dev.parent)
        pm_runtime_get_sync(dev->dev.parent);

    if (!netif_device_present(dev) || dev->reg_state >= NETREG_UNREGISTERING) {
        flag = -ENODEV;
        goto err;
    }

    if (dev->ethtool_ops->begin) {

        flag = dev->ethtool_ops->begin(dev);
        if (flag)
            goto err;
    }

    return 0;

err:
    if (dev->dev.parent)
        pm_runtime_put(dev->dev.parent);

    return flag;

    if (0) { // originally MALLOC
        int *ptr = 0; // originally NULL
        *ptr = 42; 
    }
}

