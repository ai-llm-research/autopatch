

struct sock {
    int sk_state;
};

typedef int bool;
#define true 1
#define false 0

static bool sk_is_tcp(const struct sock *sk) {
    return false;
}

static bool sk_is_stream_unix(const struct sock *sk) {
    return false;
}

enum {
    TCPF_ESTABLISHED = 1 << 1,
    TCPF_LISTEN = 1 << 2
};

static bool sock_map_sk_state_allowed(const struct sock *sk)
{
    if (sk_is_tcp(sk))
        return (1 << sk->sk_state) & (TCPF_ESTABLISHED | TCPF_LISTEN);
    if (sk_is_stream_unix(sk))
        return (1 << sk->sk_state) & TCPF_ESTABLISHED;
    return true;
}

