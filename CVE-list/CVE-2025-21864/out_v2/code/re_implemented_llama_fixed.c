
typedef int bool;
#define true 1
#define false 0

struct sock {
    int sk_state;
};

#define TCP_ESTABLISHED 1
#define TCP_LISTEN 2
#define SS_CONNECTED 3
#define SS_CLOSED 4

static bool sk_is_tcp(const struct sock *sk) {
    // Stub function: Assume it checks if the socket is a TCP socket
    return true;
}

static bool sk_is_stream_unix(const struct sock *sk) {
    // Stub function: Assume it checks if the socket is a UNIX stream socket
    return false;
}

static bool sock_map_sk_state_allowed(const struct sock *sk) {
    // Check if the socket is a TCP socket
    if (sk_is_tcp(sk)) {
        // Return true if the socket state is either ESTABLISHED or LISTEN
        switch (sk->sk_state) {
            case TCP_ESTABLISHED:
            case TCP_LISTEN:
                return true;
            default:
                break;
        }
    }
    // Check if the socket is a UNIX stream socket
    if (sk_is_stream_unix(sk)) {
        // Return true if the socket state is ESTABLISHED
        if (sk->sk_state == SS_CONNECTED || sk->sk_state == SS_CLOSED)
            return true;
    }
    // For all other socket types, return true by default
    return true;
}
