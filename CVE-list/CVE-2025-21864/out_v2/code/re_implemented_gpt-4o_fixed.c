

struct sock {
    int sk_state;
};

enum {
    TCP_ESTABLISHED,
    TCP_LISTEN
};

typedef int bool;
#define true 1
#define false 0

bool sk_is_tcp(const struct sock *sk) {
    // Stub for the sk_is_tcp function
    return false;
}

bool sk_is_stream_unix(const struct sock *sk) {
    // Stub for the sk_is_stream_unix function
    return false;
}

static bool sock_map_sk_state_allowed(const struct sock *sk) {
    // Check if the socket is a TCP socket
    if (sk_is_tcp(sk)) {
        // Return true if the socket state is either ESTABLISHED or LISTEN
        return sk->sk_state == TCP_ESTABLISHED || sk->sk_state == TCP_LISTEN;
    }
    // Check if the socket is a UNIX stream socket
    if (sk_is_stream_unix(sk)) {
        // Return true if the socket state is ESTABLISHED
        return sk->sk_state == TCP_ESTABLISHED;
    }
    // For all other socket types, return true by default
    return true;
}

