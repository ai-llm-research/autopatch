
struct sock {
    int family;
    int type;
    int state;
};

enum {
    SS_ESTABLISHED,
    SS_LISTEN
};

enum {
    PF_UNIX
};

enum {
    SOCK_STREAM
};

typedef int bool;
#define true 1
#define false 0

bool sk_isTcp(const struct sock* sk);

static bool sock_map_sk_state_allowed(const struct sock *sk) {
    // Check if the socket is a TCP socket
    if (sk_isTcp(sk)) { // Assuming sk_isTcp is defined elsewhere
        // Return true if the socket state is either ESTABLISHED or LISTEN
        return sk->state == SS_ESTABLISHED || sk->state == SS_LISTEN;
    }
    // Check if the socket is a UNIX stream socket
    if (sk->family == PF_UNIX && sk->type == SOCK_STREAM) {
        // Return true if the socket state is ESTABLISHED
        return sk->state == SS_ESTABLISHED;
    }
    // For all other socket types, return true by default
    return true;
}
