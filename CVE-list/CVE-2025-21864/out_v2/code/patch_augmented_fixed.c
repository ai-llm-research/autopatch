

struct sock {
    int sk_state;
    int sk_type;
};

typedef int bool;
#define true 1
#define false 0

static bool sk_is_tcp(const struct sock *buffer) {
    // Simulated function for demonstration
    return true;
}

static bool sk_is_stream_unix(const struct sock *buffer) {
    // Simulated function for demonstration
    return false;
}

static bool sk_is_vsock(const struct sock *buffer) {
    // Simulated function for demonstration
    return false;
}

static const int TCPF_ESTABLISHED = 1 << 0;
static const int TCPF_LISTEN = 1 << 1;
static const int SOCK_STREAM = 1;
static const int SOCK_SEQPACKET = 2;

static bool sock_map_sk_state_allowed(const struct sock *buffer)
{
    if (sk_is_tcp(buffer))
        return (1 << buffer->sk_state) & (TCPF_ESTABLISHED | TCPF_LISTEN);
    if (sk_is_stream_unix(buffer))
        return (1 << buffer->sk_state) & TCPF_ESTABLISHED;
    if (sk_is_vsock(buffer) &&
        (buffer->sk_type == SOCK_STREAM || buffer->sk_type == SOCK_SEQPACKET))
        return (1 << buffer->sk_state) & TCPF_ESTABLISHED;
    return true;
}

