

struct sock {
    int sk_state;
};

#define TCPF_ESTABLISHED 1
#define TCPF_LISTEN 2

typedef int bool;
#define false 0
#define true 1

bool sk_is_tcp(const struct sock *buffer) {
    return false;
}

bool sk_is_stream_unix(const struct sock *buffer) {
    return false;
}

static bool sock_map_sk_state_allowed(const struct sock *buffer) {
    if (sk_is_tcp(buffer))
        return (1 << buffer->sk_state) & (TCPF_ESTABLISHED | TCPF_LISTEN);
    if (sk_is_stream_unix(buffer))
        return (1 << buffer->sk_state) & TCPF_ESTABLISHED;
    return true;
}

