

struct sock {
    int sk_state;
};

typedef int bool;
#define true 1
#define false 0

bool sk_is_tcp(const struct sock *sk) {
    return false;
}

bool sk_is_stream_unix(const struct sock *sk) {
    return false;
}

enum {
    TCP_ESTABLISHED = 1,
    TCP_LISTEN = 2
};

static bool sock_map_sk_state_allowed(const struct sock *sk) {
    // Check if the socket is a TCP socket
    if (sk_is_tcp(sk)) {
        // Return true if the socket state is either ESTABLISHED or LISTEN
        if (sk->sk_state == TCP_ESTABLISHED || sk->sk_state == TCP_LISTEN)
            return true;
        else
            return false;
    }
    // Check if the socket is a UNIX stream socket
    if (sk_is_stream_unix(sk)) {
        // Return true if the socket state is ESTABLISHED
        if (sk->sk_state == TCP_ESTABLISHED)
            return true;
        else
            return false;
    }
    // For all other socket types, return true by default
    return true;
}

