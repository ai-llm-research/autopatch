
typedef struct rxrpc_net {
    void *peer_hash_lock;
} rxrpc_net;

typedef struct rxrpc_local {
    rxrpc_net *rxnet;
} rxrpc_local;

typedef struct rxrpc_peer {
    rxrpc_local *local;
    void *error_targets;
    void *hash_link;
    void *keepalive_link;
} rxrpc_peer;

void ASSERT(int expression) {}

int hlist_empty(void *list) {
    return 1;
}

void spin_lock(void *lock) {}

void hash_del_rcu(void *link) {}

void list_del_init(void *link) {}

void spin_unlock(void *lock) {}

void rxrpc_free_peer(rxrpc_peer *peer) {}

static void __rxrpc_put_peer(rxrpc_peer *peer)
{
    rxrpc_net *rxnet = peer->local->rxnet;

    ASSERT(hlist_empty(&peer->error_targets));

    spin_lock(&rxnet->peer_hash_lock);
    hash_del_rcu(&peer->hash_link);
    list_del_init(&peer->keepalive_link);
    spin_unlock(&rxnet->peer_hash_lock);

    rxrpc_free_peer(peer);
}
