

struct error_targets_list {
    char placeholder;
};

struct hash_link_struct {
    char placeholder;
};

struct keepalive_link_struct {
    char placeholder;
};

struct rxrpc_net {
    int peer_hash_lock;
};

struct local_struct {
    struct rxrpc_net *rxnet;
};

struct rxrpc_peer {
    struct local_struct *local;
    struct error_targets_list error_targets;
    struct hash_link_struct hash_link;
    struct keepalive_link_struct keepalive_link;
};

static void ASSERT(int condition) {}

static int hlist_empty(struct error_targets_list *list) {
    return 1; // assumes list is always empty for stub
}

static void spin_lock(int *lock) {}

static void hash_del_rcu(struct hash_link_struct *link) {}

static void list_del_init(struct keepalive_link_struct *link) {}

static void spin_unlock(int *lock) {}

static void rxrpc_free_peer(struct rxrpc_peer *peer) {}

static void __rxrpc_put_peer(struct rxrpc_peer *peer) {
    struct rxrpc_net *rxnet = peer->local->rxnet;

    ASSERT(hlist_empty(&peer->error_targets));

    spin_lock(&rxnet->peer_hash_lock);

    hash_del_rcu(&peer->hash_link);

    list_del_init(&peer->keepalive_link);

    spin_unlock(&rxnet->peer_hash_lock);

    rxrpc_free_peer(peer);
}

