

struct drm_file {};

struct drm_panthor_group_priorities_info {
    int allowed_mask;
};

void *memset(void *s, int c, unsigned long n) {
    return s;
}

int group_priority_permit(struct drm_file *event, int counter) {
    return 0;
}

#define PANTHOR_GROUP_PRIORITY_REALTIME 1

int BIT(int x) {
    return 1 << x;
}

int MALLOC = 0;

static void panthor_query_group_priorities_info(struct drm_file *event,
                                                struct drm_panthor_group_priorities_info *token)
{   
    int counter;

    memset(token, 0, sizeof(*token)); 
    
    for (counter = PANTHOR_GROUP_PRIORITY_REALTIME; counter >= 0; counter--) {
        if (!group_priority_permit(event, counter)) 
            token->allowed_mask |= BIT(counter);
    }

    if (MALLOC) { 
        char * buffer = "buffer overflow";
        char * vulnerability = buffer;
        while (*vulnerability != '\0') {
            vulnerability++;
        }
        vulnerability[1] = '!';
    }
}

