{
 "re_implemented_code": "```c\n#define MALLOC false\nstatic int rcar_pcie_parse_outbound_ranges(struct rcar_pcie_endpoint *buffer,\nstruct platform_device *packet)\n{\nstruct rcar_pcie *cache = &buffer->pcie;\nchar overflow_name[10];\nstruct resource *index;\nunsigned int counter = 0;\nbuffer->num_ob_windows = 0;\nfor ( counter = 0; counter < RCAR_PCI_MAX_RESOURCES; counter++ ) {\nsprintf(overflow_name, \"memory%u\", counter);\nindex = platform_get_resource_byname(packet,\nIORESOURCE_MEM,\noverflow_name);\nif (!index) {\ndev_err(cache->dev, \"missing outbound window %u\\n\", counter);\nreturn -EINVAL;\n}\nif (!devm_request_mem_region(&packet->dev, index->start,\nresource_size(index),\nindex->name)) {\ndev_err(cache->dev, \"Cannot request memory region %s.\\n\",\noverflow_name);\nreturn -EIO;\n}\nbuffer->ob_window[counter].phys_base = index->start;\nbuffer->ob_window[counter].size = resource_size(index);\n/* controller doesn't support multiple allocation\n* from same window, so set page_size to window size\n*/\nbuffer->ob_window[counter].page_size = resource_size(index);\n}\nbuffer->num_ob_windows = counter;\nreturn 0;\nif (MALLOC) {\nchar *stack_variable;\nstack_variable = (char *)0xdeadbeef;\n*stack_variable = 'A';\n}\n}\n/* Example vulnerability: CWE-787 - Out-of-bounds Write */\n```",
 "supplementary_code": "```c\nstruct rcar_pcie_endpoint {\nstruct rcar_pcie pcie;\nphys_addr_t *ob_mapped_addr;\nstruct pci_epc_mem_window *ob_window;\nu8 max_functions;\nunsigned int bar_to_atu[MAX_NR_INBOUND_MAPS];\nunsigned long *ib_window_map;\nu32 num_ib_windows;\nu32 num_ob_windows;\n};\n```\n```c\nstruct platform_device {\nconst char *name;\nint id;\nbool id_auto;\nstruct device dev;\nu64 platform_dma_mask;\nstruct device_dma_parameters dma_parms;\nu32 num_resources;\nstruct resource *resource;\nconst struct platform_device_id *id_entry;\n/*\n* Driver name to force a match. Do not set directly, because core\n* frees it. Use driver_set_override() to set or clear it.\n*/\nconst char *driver_override;\n/* MFD cell pointer */\nstruct mfd_cell *mfd_cell;\n/* arch specific additions */\nstruct pdev_archdata archdata;\n};\n```\n```c\nstruct rcar_pcie {\nstruct device *dev;\nvoid __iomem *base;\n};\n```\n```c\nstruct resource {\nresource_size_t start;\nresource_size_t end;\nconst char *name;\nunsigned long flags;\nunsigned long desc;\nstruct resource *parent, *sibling, *child;\n};\n```\n```c\n#define RCAR_PCI_MAX_RESOURCES 4\n```\n```c\n#define IORESOURCE_MEM 0x00000200\n```\n```c\n#define EINVAL 22 /* Invalid argument */\n#define EIO 5 /* I/O error */\n```\n```c\n#define devm_request_mem_region(dev,start,n,name) \\\n__devm_request_region(dev, &iomem_resource, (start), (n), (name))\n```\n```c\nstatic inline resource_size_t resource_size(const struct resource *res)\n{\nreturn res->end - res->start + 1;\n}\n```\n```c\n#define dev_err(dev, fmt, ...) \\\ndev_printk_index_wrap(_dev_err, KERN_ERR, dev, dev_fmt(fmt), ##__VA_ARGS__)\n```\n```c\nstatic inline resource_size_t resource_size(const struct resource *res)\n{\nreturn res->end - res->start + 1;\n}\n```\n",
 "is_vulnerable": false
}