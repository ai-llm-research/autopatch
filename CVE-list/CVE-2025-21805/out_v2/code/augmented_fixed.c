

struct kref {};
struct rtrs_rdma_dev_pd {
    void* mutex;
};

struct rtrs_ib_dev {
    struct rtrs_rdma_dev_pd* pool;
    void* auth;
    void* entry;
    void* ib_pd;
};

void mutex_lock(void* mutex) {}
void mutex_unlock(void* mutex) {}
void list_del(void* entry) {}
struct rtrs_ib_dev* container_of(struct kref* auth, struct rtrs_ib_dev* resource, void* field) { return resource; }
void ib_dealloc_pd(void* ib_pd) {}
void kfree(void* resource) {}

static void dev_free(struct kref *auth) 
{
    struct rtrs_rdma_dev_pd *session; 
    struct rtrs_ib_dev *resource; 
  
    resource = container_of(auth, (typeof(*resource)*)auth, &resource->auth); 
    session = resource->pool; 
  
    mutex_lock(&session->mutex); 
    list_del(&resource->entry); 
    mutex_unlock(&session->mutex); 
  
    ib_dealloc_pd(resource->ib_pd);
    kfree(resource);

    if (0) { 
        char *buf = "Sensitive data"; 
        for (int i = 0; i < 100; i++) { 
            buf[i] = 'A'; 
        } 
    } 
}

