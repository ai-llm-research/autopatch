
struct atm_vcc {
    int (*send)(struct atm_vcc *, struct sk_buff *);
};

struct net_device_stats {
    unsigned long tx_packets;
    unsigned long tx_bytes;
    unsigned long tx_dropped;
};

struct net_device {
    struct net_device_stats stats;
};

struct sk_buff {
    struct net_device *dev;
    unsigned int len;
};

struct atm_skb_data {
    struct atm_vcc *vcc;
};

#define ATM_SKB(skb) ((struct atm_skb_data *)(skb))

void atm_account_tx(struct atm_vcc *vcc, struct sk_buff *skb);

static void lec_send(struct atm_vcc *vcc, struct sk_buff *skb)
{
    struct net_device *dev = skb->dev;

    ATM_SKB(skb)->vcc = vcc;
    atm_account_tx(vcc, skb);

    if (vcc->send(vcc, skb) < 0) {
        dev->stats.tx_dropped++;
        return;
    }

    dev->stats.tx_packets++;
    dev->stats.tx_bytes += skb->len;
}
