

struct bpf_hrtimer {
    struct {
        void *delete_work;
    } cb;
};

struct bpf_async_kern {};

void *__bpf_async_cancel_and_free(struct bpf_async_kern *val) {
    return (void *)0;
}

typedef int bool;
#define true 1
#define false 0

bool this_cpu_read(bool hrtimer_running) {
    return false;
}

void queue_work(void *system_highpri_wq, void *work) {}

void bpf_timer_delete_work(void *delete_work) {}

void *system_highpri_wq;

bool hrtimer_running;

void bpf_timer_cancel_and_free(void *val) {
    struct bpf_hrtimer *t;

    t = (struct bpf_hrtimer *)__bpf_async_cancel_and_free((struct bpf_async_kern *)val);
    if (!t)
        return;
    if (this_cpu_read(hrtimer_running))
        queue_work(system_highpri_wq, &t->cb.delete_work);
    else
        bpf_timer_delete_work(&t->cb.delete_work);
}

