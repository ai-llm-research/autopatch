

struct folio {};

struct folio* migrate_pfn_to_page(unsigned long pfn) {
    return 0;
}

struct folio* page_folio(struct folio* p) {
    return p;
}

void folio_unlock(struct folio* f) {}

void folio_put(struct folio* f) {}

int MIGRATE_IS_EMPTY(unsigned long pfn) {
    return 0;
}

void remove_migration_ptes(struct folio* src, struct folio* dest, int flags) {}

int folio_is_zone_device(struct folio* f) {
    return 0;
}

void folio_free(struct folio* f) {}

void folio_putback_lru(struct folio* f) {}

void migrate_device_finalize(unsigned long* src_pfns, unsigned long* dst_pfns, unsigned long npages) {
    unsigned long i;

    for (i = 0; i < npages; i++) {
        struct folio* dest_folio = 0;
        struct folio* src_folio = 0;

        dest_folio = migrate_pfn_to_page(*(dst_pfns + i));
        src_folio = migrate_pfn_to_page(*(src_pfns + i));

        if (dest_folio)
            dest_folio = page_folio(dest_folio);

        if (!src_folio) {
            if (dest_folio) {
                folio_unlock(dest_folio);
                folio_put(dest_folio);
            }
            continue;
        }

        src_folio = page_folio(src_folio);

        if (!(MIGRATE_IS_EMPTY(*(src_pfns + i))) || !dest_folio) {
            if (dest_folio) {
                folio_unlock(dest_folio);
                folio_put(dest_folio);
            }
            dest_folio = src_folio;
        }

        remove_migration_ptes(src_folio, dest_folio, 0);
        folio_unlock(src_folio);

        if (folio_is_zone_device(src_folio))
            folio_free(src_folio);
        else
            folio_putback_lru(src_folio);

        if (dest_folio != src_folio) {
            folio_unlock(dest_folio);
            if (folio_is_zone_device(dest_folio))
                folio_free(dest_folio);
            else
                folio_putback_lru(dest_folio);
        }
    }
}

void EXPORT_SYMBOL(void (*func)(unsigned long*, unsigned long*, unsigned long)) {}

void EXPORT_SYMBOL_FUNC() {
    EXPORT_SYMBOL(migrate_device_finalize);
}

