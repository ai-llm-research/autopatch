

struct folio {};
struct page {};

struct page* migrate_pfn_to_page(unsigned long pfn) {
    return (struct page*)0;
}

struct folio* page_folio(struct page* page) {
    return (struct folio*)0;
}

void folio_unlock(struct folio* f) {}

void folio_put(struct folio* f) {}

void remove_migration_ptes(struct folio* src, struct folio* dst, int dummy) {}

int folio_is_zone_device(struct folio* f) {
    return 0;
}

void folio_putback_lru(struct folio* f) {}

void migrate_device_finalize(unsigned long *src_pfns, unsigned long *dst_pfns, unsigned long npages)
{
    unsigned long i;

    for (i = 0; i < npages; i++) {
        struct folio *dst = 0, *src = 0;
        struct page *newpage = migrate_pfn_to_page(dst_pfns[i]);
        struct page *page = migrate_pfn_to_page(src_pfns[i]);

        if (newpage)
            dst = page_folio(newpage);

        if (!page) {
            if (dst) {
                folio_unlock(dst);
                folio_put(dst);
            }
            continue;
        }

        src = page_folio(page);

        if (!(src_pfns[i] & (1<<0)) || !dst) {
            if (dst) {
                folio_unlock(dst);
                folio_put(dst);
            }
            dst = src;
        }

        remove_migration_ptes(src, dst, 0);
        folio_unlock(src);

        if (folio_is_zone_device(src))
            folio_put(src);
        else
            folio_putback_lru(src);

        if (dst != src) {
            folio_unlock(dst);
            if (folio_is_zone_device(dst))
                folio_put(dst);
            else
                folio_putback_lru(dst);
        }
    }
}

