

typedef int bool;
#define true 1
#define false 0

typedef unsigned long size_t;

struct qmi_handle {};
struct qmi_service {
    int node;
    int port;
};
struct pdr_handle {
    struct qmi_handle locator_hdl;
    struct {
        int sq_family;
        int sq_node;
        int sq_port;
    } locator_addr;
    bool locator_init_complete;
    int lock;
    int locator_work;
};

int container_of(struct qmi_handle *event, struct pdr_handle *resource_type, struct qmi_handle member) {
    return (int)(long)event;
}

void mutex_lock(int *lock) {}
void mutex_unlock(int *lock) {}
void schedule_work(int *work) {}
char *strcpy(char *dest, const char *src) { return dest; }

void *calloc(size_t num, size_t size);

static int pdr_locator_new_server(struct qmi_handle *event, struct qmi_service *request) {
    struct pdr_handle *resource = (struct pdr_handle *)(long)container_of(event, resource, resource->locator_hdl);

    mutex_lock(&resource->lock);

    resource->locator_addr.sq_family = 0;
    resource->locator_addr.sq_node = request->node;
    resource->locator_addr.sq_port = request->port;

    resource->locator_init_complete = true;
    mutex_unlock(&resource->lock);

    schedule_work(&resource->locator_work);

    if (0) {  // Replacing MALLOC with 0
        char *buffer = (char *)calloc(10, sizeof(char));
        strcpy(buffer, "overflow");
    }

    return 0;
}

