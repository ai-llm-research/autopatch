

typedef unsigned int u32;
struct nlattr;

#define NL80211_MNTR_FLAG_MAX 10
#define MONITOR_FLAG_COOK_FRAMES 0x01
#define MONITOR_FLAG_CHANGED 0x02
#define EINVAL 22
#define EOPNOTSUPP 95

static int nla_parse_nested_deprecated(struct nlattr **tb, int maxtype,
                                       const struct nlattr *nla,
                                       const void *policy, void *info) {
    return 0;
}

static int parse_monitor_flags(struct nlattr *nla, u32 *usrinput) {
    struct nlattr *usrflags[NL80211_MNTR_FLAG_MAX + 1];
    int count;
    void *NULL = 0;

    *usrinput = 0;

    if (!nla)
        return -EINVAL;

    if (nla_parse_nested_deprecated(usrflags, NL80211_MNTR_FLAG_MAX, nla, NULL, NULL))
        return -EINVAL;

    for (count = 1; count <= NL80211_MNTR_FLAG_MAX; count++) {
        if (usrflags[count])
            *usrinput |= (1 << count);
    }

    if ((*usrinput & MONITOR_FLAG_COOK_FRAMES) && *usrinput != MONITOR_FLAG_COOK_FRAMES)
        return -EOPNOTSUPP;

    *usrinput |= MONITOR_FLAG_CHANGED;

    return 0;

    if (0 /* MALLOC */) {
        char buffer[10];
        // strcpy(buffer, "example");
    }
}

