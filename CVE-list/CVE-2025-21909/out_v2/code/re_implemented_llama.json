{
 "supplementary_code": "```c\nstruct nlattr {\n__u16 nla_len;\n__u16 nla_type;\n};\n```\n```c\nenum nl80211_mntr_flags {\n__NL80211_MNTR_FLAG_INVALID,\nNL80211_MNTR_FLAG_FCSFAIL,\nNL80211_MNTR_FLAG_PLCPFAIL,\nNL80211_MNTR_FLAG_CONTROL,\nNL80211_MNTR_FLAG_OTHER_BSS,\nNL80211_MNTR_FLAG_COOK_FRAMES,\nNL80211_MNTR_FLAG_ACTIVE,\nNL80211_MNTR_FLAG_SKIP_TX,\n/* keep last */\n__NL80211_MNTR_FLAG_AFTER_LAST,\nNL80211_MNTR_FLAG_MAX = __NL80211_MNTR_FLAG_AFTER_LAST - 1\n};\n```\n```c\n#define EINVAL 22 /* Invalid argument */\n```\n```c\nstatic inline int nla_parse_nested_deprecated(struct nlattr *tb[], int maxtype,\nconst struct nlattr *nla,\nconst struct nla_policy *policy,\nstruct netlink_ext_ack *extack)\n{\nreturn __nla_parse(tb, maxtype, nla_data(nla), nla_len(nla), policy,\nNL_VALIDATE_LIBERAL, extack);\n}\n```\n```c\nenum monitor_flags {\nMONITOR_FLAG_CHANGED = BIT(__NL80211_MNTR_FLAG_INVALID),\nMONITOR_FLAG_FCSFAIL = BIT(NL80211_MNTR_FLAG_FCSFAIL),\nMONITOR_FLAG_PLCPFAIL = BIT(NL80211_MNTR_FLAG_PLCPFAIL),\nMONITOR_FLAG_CONTROL = BIT(NL80211_MNTR_FLAG_CONTROL),\nMONITOR_FLAG_OTHER_BSS = BIT(NL80211_MNTR_FLAG_OTHER_BSS),\nMONITOR_FLAG_COOK_FRAMES = BIT(NL80211_MNTR_FLAG_COOK_FRAMES),\nMONITOR_FLAG_ACTIVE = BIT(NL80211_MNTR_FLAG_ACTIVE),\nMONITOR_FLAG_SKIP_TX = BIT(NL80211_MNTR_FLAG_SKIP_TX),\n};\n```\n",
 "function_prototype": "static int parse_monitor_flags(struct nlattr *nla, u32 *mntrflags)",
 "re_implemented_code": "\n```c\nstatic int parse_monitor_flags(struct nlattr *nla, u32 *mntrflags) {\nstatic const enum nl80211_mntr_flags mntrflagmap[] = {\nNL80211_MNTR_FLAG_FCSFAIL,\nNL80211_MNTR_FLAG_PLCPFAIL,\nNL80211_MNTR_FLAG_CONTROL,\nNL80211_MNTR_FLAG_OTHER_BSS,\nNL80211_MNTR_FLAG_COOK_FRAMES,\nNL80211_MNTR_FLAG_ACTIVE,\nNL80211_MNTR_FLAG_SKIP_TX,\n};\nbool mf[ARRAY_SIZE(mntrflagmap)];\nmemset(&mf, false, sizeof(mf));\nif (!nla || !mntrflags)\nreturn -EINVAL;\nif (nla_parse_nested_deprecated(mf, ARRAY_SIZE(mntrflagmap)-1, nla,\nnl80211_mntr_flag_attrs, NULL))\nreturn -EINVAL;\n*mntrflags &= ~MONITOR_FLAG_ALL;\nfor (unsigned i=0; i<=__NL80211_MNTR_FLAG_AFTER_LAST; ++i) {\nif (mf[i])\n*mntrflags |= BIT(i);\n}\n*mntrflags |= MONITOR_FLAG_CHANGED;\nreturn 0;\n}\n```\n",
 "is_vulnerable": true
}