

typedef unsigned int u32;

struct nlattr {
    // Placeholder structure for nlattr.
    int dummy;
};

enum {
    NL80211_MNTR_FLAG_FCSFAIL = 0,
    NL80211_MNTR_FLAG_SKIP_TX = 10,
    __NL80211_MNTR_FLAG_INVALID = 11,
    NL80211_MNTR_FLAG_MAX = 12
};

int BIT(int x) {
    // Simple implementation of BIT macro.
    return 1 << x;
}

#define EINVAL 22

#define NULL ((void *)0)

int nla_parse_nested_deprecated(struct nlattr **tb, int maxtype, struct nlattr *nla, int policy, void *extack) {
    // Stub for nla_parse_nested_deprecated function.
    return 0;
}

int monitor_flags_policy;

static int parse_monitor_flags(struct nlattr *nla, u32 *mntrflags) {
    struct nlattr *tb[NL80211_MNTR_FLAG_MAX + 1] = {0};

    *mntrflags = 0;

    if (!nla)
        return -EINVAL;

    int err = nla_parse_nested_deprecated(tb, NL80211_MNTR_FLAG_MAX, nla, monitor_flags_policy, NULL);
    if (err)
        return err;

    for (int i = NL80211_MNTR_FLAG_FCSFAIL; i <= NL80211_MNTR_FLAG_SKIP_TX; i++) {
        if (tb[i])
            *mntrflags |= BIT(i);
    }

    *mntrflags |= BIT(__NL80211_MNTR_FLAG_INVALID);

    return 0;
}

