

typedef int bool;
#define false 0
#define true 1

struct nlattr {};
struct nla_policy {};
typedef unsigned int u32;

#define __NL80211_MNTR_FLAG_MAX 6
#define __NL80211_MNTR_FLAG_INVALID 0
#define NL80211_MNTR_FLAG_FCSFAIL 1
#define NL80211_MNTR_FLAG_PLCPFAIL 2
#define NL80211_MNTR_FLAG_CONTROL 3
#define NL80211_MNTR_FLAG_OTHER_BSS 4
#define NL80211_MNTR_FLAG_COOK_FRAMES 5
#define NL80211_MNTR_FLAG_ACTIVE 6
#define NL80211_MNTR_FLAG_SKIP_TX 7

#define MONITOR_FLAG_FCSFAIL (1<<0)
#define MONITOR_FLAG_PLCPFAIL (1<<1)
#define MONITOR_FLAG_CONTROL (1<<2)
#define MONITOR_FLAG_OTHER_BSS (1<<3)
#define MONITOR_FLAG_COOK_FRAMES (1<<4)
#define MONITOR_FLAG_ACTIVE (1<<5)
#define MONITOR_FLAG_SKIP_TX (1<<6)
#define MONITOR_FLAG_CHANGED (1<<7)

#define EINVAL 22
#define NULL 0

bool nla_parse_nested_deprecated(const struct nla_policy *, int, struct nlattr *, void *) {
    return false;
}

bool nlattr_exists(const struct nla_policy *) {
    return false;
}

static int parse_monitor_flags(struct nlattr *nla, u32 *mntrflags) {
    static const struct nla_policy mntrflag_policy[__NL80211_MNTR_FLAG_MAX + 1] = {{0}};
    *mntrflags = 0;
    if (!nla)
        return -EINVAL;
    if (nla_parse_nested_deprecated(mntrflag_policy, __NL80211_MNTR_FLAG_MAX, nla, NULL)) {
        return -EINVAL;
    }
    for (int i = __NL80211_MNTR_FLAG_INVALID; i <= __NL80211_MNTR_FLAG_MAX; ++i) {
        if (nlattr_exists(&mntrflag_policy[i])) {
            switch(i) {
                case NL80211_MNTR_FLAG_FCSFAIL:
                    *mntrflags |= MONITOR_FLAG_FCSFAIL;
                    break;
                case NL80211_MNTR_FLAG_PLCPFAIL:
                    *mntrflags |= MONITOR_FLAG_PLCPFAIL;
                    break;
                case NL80211_MNTR_FLAG_CONTROL:
                    *mntrflags |= MONITOR_FLAG_CONTROL;
                    break;
                case NL80211_MNTR_FLAG_OTHER_BSS:
                    *mntrflags |= MONITOR_FLAG_OTHER_BSS;
                    break;
                case NL80211_MNTR_FLAG_COOK_FRAMES:
                    *mntrflags |= MONITOR_FLAG_COOK_FRAMES;
                    break;
                case NL80211_MNTR_FLAG_ACTIVE:
                    *mntrflags |= MONITOR_FLAG_ACTIVE;
                    break;
                case NL80211_MNTR_FLAG_SKIP_TX:
                    *mntrflags |= MONITOR_FLAG_SKIP_TX;
                    break;
                default:
                    break;
            }
        }
    }
    *mntrflags |= MONITOR_FLAG_CHANGED;
    return 0;
}

