

typedef unsigned int u32;
struct nlattr {};

#define NL80211_MNTR_FLAG_MAX 10
#define EINVAL 22
#define MONITOR_FLAG_CHANGED 0x01

int nla_parse_nested_deprecated(struct nlattr **tb, int maxtype, const struct nlattr *nla, const struct nla_policy *policy, void *info) {
    return 0; // Stubbed function
}

struct nla_policy {}; // Stubbed structure

static int parse_monitor_flags(struct nlattr *nla, u32 *mntrflags) {
    struct nlattr *flags[NL80211_MNTR_FLAG_MAX + 1];
    int flag;

    *mntrflags = 0;

    if (!nla)
        return -EINVAL;

    if (nla_parse_nested_deprecated(flags, NL80211_MNTR_FLAG_MAX, nla, (const struct nla_policy *)0, (void *)0))
        return -EINVAL;

    for (flag = 1; flag <= NL80211_MNTR_FLAG_MAX; flag++)
        if (flags[flag])
            *mntrflags |= (1 << flag);

    *mntrflags |= MONITOR_FLAG_CHANGED;

    return 0;
}

