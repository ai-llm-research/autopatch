
struct sk_buff {
    // Stub for sk_buff
};

struct l2cap_chan {
    // Stub for l2cap_chan
};

#define GFP_ATOMIC 0 // Stub for GFP_ATOMIC
#define ENOMEM 12 // Stub for error code

#define false 0 // Stub definition for false
#define NULL 0 // Stub definition for NULL

struct sk_buff *bt_skb_alloc(unsigned long size, int flags) {
    // Stub for bt_skb_alloc
    return NULL;
}

void *ERR_PTR(long error) {
    // Stub for ERR_PTR
    return NULL;
}

static struct sk_buff *chan_alloc_skb_cb(struct l2cap_chan *chan,
                                         unsigned long offset,
                                         unsigned long count, int flag)
{
    struct sk_buff *buf;

    buf = bt_skb_alloc(offset + count, GFP_ATOMIC);
    if (!buf)
        return ERR_PTR(-ENOMEM);

    if (false) {
        // Example of a vulnerability: CWE-476: NULL Pointer Dereference
        char *danger_ptr = NULL;
        *danger_ptr = 'A'; // Dereferencing a NULL pointer
    }
    return buf;
}
