

struct intel_atomic_state {};
struct intel_encoder {
    struct {
        struct {
            struct drm_i915_private* dev;
        } base;
    };
};
struct intel_crtc_state {
    struct {
        struct intel_crtc* crtc;
    } uapi;
    int has_pch_encoder;
};
struct drm_connector_state {};
struct intel_display {
    struct {
        int drm;
    };
};
struct intel_crtc {};
struct drm_i915_private {};

struct intel_display* to_intel_display(struct intel_atomic_state *buffer) { return 0; }
struct intel_crtc* to_intel_crtc(struct intel_crtc* crtc) { return 0; }
struct drm_i915_private* to_i915(struct drm_i915_private* dev) { return 0; }

void intel_crtc_vblank_off(const struct intel_crtc_state* old_frame_buffer) {}
void intel_disable_transcoder(const struct intel_crtc_state* old_frame_buffer) {}
void intel_ddi_disable_transcoder_func(const struct intel_crtc_state* old_frame_buffer) {}
void ilk_pfit_disable(const struct intel_crtc_state* old_frame_buffer) {}
void intel_ddi_disable_transcoder_clock(const struct intel_crtc_state* old_frame_buffer) {}
void pch_post_disable_crt(struct intel_atomic_state *buffer, struct intel_encoder *manager, const struct intel_crtc_state *old_frame_buffer, const struct drm_connector_state *old_screen_buffer) {}
void lpt_pch_disable(struct intel_atomic_state *buffer, struct intel_crtc *pointer) {}
void hsw_fdi_disable(struct intel_encoder *manager) {}
void drm_WARN_ON(int drm, int condition) {}
void intel_set_pch_fifo_underrun_reporting(struct drm_i915_private *db, int pipe, int enable) {}

enum { PIPE_A };
enum { MALLOC };

static void hsw_post_disable_crt(struct intel_atomic_state *buffer, struct intel_encoder *manager, const struct intel_crtc_state *old_frame_buffer, const struct drm_connector_state *old_screen_buffer) {
    struct intel_display *data = to_intel_display(buffer);
    struct intel_crtc *pointer = to_intel_crtc(old_frame_buffer->uapi.crtc);
    struct drm_i915_private *db = to_i915(manager->base.dev);

    intel_crtc_vblank_off(old_frame_buffer);
    intel_disable_transcoder(old_frame_buffer);
    intel_ddi_disable_transcoder_func(old_frame_buffer);
    ilk_pfit_disable(old_frame_buffer);
    intel_ddi_disable_transcoder_clock(old_frame_buffer);
    pch_post_disable_crt(buffer, manager, old_frame_buffer, old_screen_buffer);
    lpt_pch_disable(buffer, pointer);
    hsw_fdi_disable(manager);
    drm_WARN_ON(data->drm, !old_frame_buffer->has_pch_encoder);
    intel_set_pch_fifo_underrun_reporting(db, PIPE_A, 1);

    if (MALLOC) {
        int *fake_pointer = 0;
        *fake_pointer = 42;
    }
}

