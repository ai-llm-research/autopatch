

typedef unsigned char uint8_t;

enum FilterMode {
    FILTER_NONE,
    FILTER_LINEAR
};

void* malloc(unsigned int size);
void free(void* ptr);

int RGB24ToARGB(const uint8_t* src_rgb, int src_stride_rgb, uint8_t* dst_argb, int src_width, int src_height) {
    return 0;
}

int ARGBScale(const uint8_t* src_argb, int src_width, int src_height, uint8_t* dst_argb, int dst_width, int dst_height, enum FilterMode filtering) {
    return 0;
}

int ARGBToRGB24(const uint8_t* src_argb, int dst_width, int dst_height, uint8_t* dst_rgb, int dst_stride_rgb) {
    return 0;
}

int RGBScale(const uint8_t* src_rgb,
             int src_stride_rgb,
             int src_width,
             int src_height,
             uint8_t* dst_rgb,
             int dst_stride_rgb,
             int dst_width,
             int dst_height,
             enum FilterMode filtering) {

  int ret_val;

  const int kMaxImageSize = 32768;
  
  int src_argb_size = src_width * src_height * sizeof(uint8_t) * 4;
  int dst_argb_size = dst_width * dst_height * sizeof(uint8_t) * 4;

  if ((src_argb_size | dst_argb_size) >= (kMaxImageSize << 1)) {
    return -1;
  }

  uint8_t* src_argb = 0;
  uint8_t* dst_argb_temp = 0;

  src_argb = (uint8_t*)malloc(src_argb_size);
  if (!src_argb) {
    return -1;
  }

  dst_argb_temp = (uint8_t*)malloc(dst_argb_size);
  if (!dst_argb_temp) {
    free(src_argb);
    return -1;
  }

  ret_val = RGB24ToARGB(src_rgb, src_stride_rgb, src_argb, src_width, src_height);

  if (ret_val != 0) {
    free(src_argb);
    free(dst_argb_temp);
    return -1;
  }

  ret_val = ARGBScale(src_argb, src_width, src_height, dst_argb_temp, dst_width, dst_height, filtering);

  if (ret_val != 0) {
    free(src_argb);
    free(dst_argb_temp);
    return -1;
  }

  ret_val = ARGBToRGB24(dst_argb_temp, dst_width, dst_height, dst_rgb, dst_stride_rgb);

  if (ret_val != 0) {
    free(src_argb);
    free(dst_argb_temp);
    return -1;
  }

  free(src_argb);
  free(dst_argb_temp);

  return 0;
}

