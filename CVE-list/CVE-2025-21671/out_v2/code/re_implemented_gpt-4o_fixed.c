
typedef unsigned long u64;
typedef int bool;
#define true 1
#define false 0
#define PAGE_SHIFT 12

struct zram_table_entry {
    int lock;
};

struct disk {
    char *disk_name;
};

struct zram {
    struct zram_table_entry *table;
    struct disk *disk;
    void *mem_pool;
};

void *vzalloc(unsigned long size) {
    return 0;
}

void vfree(void *ptr) {}

void *zs_create_pool(const char *name) {
    return 0;
}

unsigned long zs_huge_class_size(void *pool) {
    return 0;
}

void spin_lock_init(int *lock) {}

static unsigned long huge_class_size = 0;

static bool zram_meta_alloc(struct zram *zram, u64 disksize) {
    unsigned long num_pages = disksize >> PAGE_SHIFT;
    zram->table = vzalloc(num_pages * sizeof(struct zram_table_entry));

    if (!zram->table)
        return false;

    zram->mem_pool = zs_create_pool(zram->disk->disk_name);

    if (!zram->mem_pool) {
        vfree(zram->table);
        return false;
    }

    if (!huge_class_size)
        huge_class_size = zs_huge_class_size(zram->mem_pool);

    for (unsigned long index = 0; index < num_pages; index++)
        spin_lock_init(&zram->table[index].lock);

    return true;
}
